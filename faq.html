<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>자주 묻는 질문</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: var(--tg-theme-bg-color, #ffffff);
    --text: var(--tg-theme-text-color, #000000);
    --hint: var(--tg-theme-hint-color, #999999);
    --link: var(--tg-theme-link-color, #2678b6);
    --btn: var(--tg-theme-button-color, #2678b6);
    --btn-text: var(--tg-theme-button-text-color, #ffffff);
    --secondary-bg: var(--tg-theme-secondary-bg-color, #f0f0f0);
  }
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: var(--secondary-bg);
    color: var(--text);
    min-height: 100vh;
    -webkit-font-smoothing: antialiased;
  }
  .container { max-width: 480px; margin: 0 auto; padding: 16px; }

  .page-title { font-size: 20px; font-weight: 700; margin-bottom: 4px; }
  .page-sub { font-size: 13px; color: var(--hint); margin-bottom: 16px; }

  /* Category nav pills */
  .cat-nav { display: flex; gap: 6px; overflow-x: auto; padding-bottom: 12px; -webkit-overflow-scrolling: touch; }
  .cat-nav::-webkit-scrollbar { display: none; }
  .nav-pill {
    flex-shrink: 0; padding: 6px 14px; border-radius: 20px; font-size: 13px; font-weight: 500;
    background: var(--bg); color: var(--hint); border: 1px solid var(--secondary-bg);
    cursor: pointer; transition: all 0.2s; -webkit-tap-highlight-color: transparent;
  }
  .nav-pill.active { background: var(--btn); color: var(--btn-text); border-color: var(--btn); }

  /* Accordion card */
  .faq-card {
    background: var(--bg); border-radius: 14px; margin-bottom: 8px;
    overflow: hidden; transition: margin 0.2s;
  }
  .faq-q {
    display: flex; align-items: center; justify-content: space-between;
    padding: 14px 16px; cursor: pointer; -webkit-tap-highlight-color: transparent;
    gap: 12px;
  }
  .faq-q-text { font-size: 14px; font-weight: 600; line-height: 1.4; flex: 1; }
  .faq-arrow {
    flex-shrink: 0; width: 20px; height: 20px;
    display: flex; align-items: center; justify-content: center;
    transition: transform 0.25s ease;
  }
  .faq-arrow svg { width: 14px; height: 14px; fill: none; stroke: var(--hint); stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }
  .faq-card.open .faq-arrow { transform: rotate(180deg); }

  .faq-a {
    max-height: 0; overflow: hidden;
    transition: max-height 0.3s ease;
  }
  .faq-a-inner {
    padding: 0 16px 14px;
    font-size: 13px; line-height: 1.6; color: var(--hint);
  }
  .faq-a-inner .cmd {
    display: inline-block; padding: 1px 6px; border-radius: 4px;
    background: var(--secondary-bg); font-size: 12px; font-weight: 600; color: var(--text);
  }

  /* Category label */
  .cat-label {
    font-size: 12px; font-weight: 600; color: var(--link);
    padding: 12px 0 6px; margin-left: 4px;
  }

  @keyframes fadeIn { from { opacity: 0; transform: translateY(6px); } to { opacity: 1; transform: translateY(0); } }
  .faq-list { animation: fadeIn 0.3s ease; }
</style>
</head>
<body>
<div class="container">
  <div class="page-title">자주 묻는 질문</div>
  <div class="page-sub">궁금한 점을 찾아보세요</div>

  <div class="cat-nav" id="cat-nav"></div>
  <div id="faq-list"></div>
</div>

<script>
var tg = window.Telegram && window.Telegram.WebApp;
if (tg) {
  tg.ready();
  tg.expand();
  if (tg.BackButton) {
    tg.BackButton.show();
    tg.BackButton.onClick(function() {
      if (window.history.length > 1) { window.history.back(); }
      else { tg.close(); }
    });
  }
}

var CATEGORIES = [
  { id: 'all', label: '전체' },
  { id: 'start', label: '시작하기' },
  { id: 'core', label: '핵심 기능' },
  { id: 'daily', label: '일상 활용' },
  { id: 'growth', label: '레벨과 성장' },
  { id: 'settings', label: '설정' }
];

var FAQ = [
  {
    cat: 'start',
    q: '마이 러닝 코치는 어떤 서비스인가요?',
    a: 'Garmin 러닝 데이터를 기반으로 한 <strong>AI 맞춤 러닝 코칭 텔레그램 봇</strong>입니다. 훈련 계획 생성, 러닝 진단, 훈련법 추천, 자유 질문 등 다양한 코칭 기능을 제공합니다.'
  },
  {
    cat: 'start',
    q: 'Garmin 연동은 어떻게 하나요?',
    a: '<span class="cmd">/start</span>를 입력하면 온보딩이 시작됩니다. Garmin Connect 앱에서 <strong>intervals.icu 자동 동기화를 설정</strong>한 뒤, 안내에 따라 연동하면 됩니다.'
  },
  {
    cat: 'start',
    q: '프로필 설문은 꼭 해야 하나요?',
    a: '설문을 작성하면 AI가 더 정확한 맞춤 코칭을 제공합니다. 건너뛰어도 기본 기능은 사용할 수 있지만, <strong>코칭 품질이 크게 향상</strong>되므로 권장합니다.'
  },
  {
    cat: 'core',
    q: '훈련 계획은 어떻게 생성되나요?',
    a: '<span class="cmd">/plan</span> 명령어를 사용하면 AI가 최근 러닝 데이터, 프로필, 훈련법을 종합 분석하여 <strong>7일 맞춤 훈련 계획</strong>을 생성합니다. 생성된 계획은 수정 요청도 가능합니다.'
  },
  {
    cat: 'core',
    q: '러닝 진단은 무엇인가요?',
    a: '<span class="cmd">/status</span>를 입력하면 현재 훈련 단계, 주간 볼륨 추이, 핵심 지표, 전환 신호 체크리스트 등을 <strong>종합 분석</strong>하여 보여줍니다.'
  },
  {
    cat: 'core',
    q: '자유 질문은 어떻게 하나요?',
    a: '명령어(<span class="cmd">/</span>) 없이 메시지를 보내면 AI가 답변합니다. 예: "지난주 총 거리가 얼마야?", "이번 주 인터벌 어떻게 하면 좋을까?" 등 <strong>러닝 관련 무엇이든</strong> 물어보세요.'
  },
  {
    cat: 'daily',
    q: '날씨 정보는 어디 기준인가요?',
    a: '<span class="cmd">/weather</span>는 프로필에 설정된 지역 기준으로 날씨를 안내합니다. <span class="cmd">/profile</span>에서 지역을 변경할 수 있습니다.'
  },
  {
    cat: 'daily',
    q: '어떤 기록을 볼 수 있나요?',
    a: '<span class="cmd">/history</span>를 입력하면 Garmin에서 동기화된 최근 러닝 기록을 확인할 수 있습니다. <strong>거리, 시간, 페이스</strong> 등 주요 지표를 한눈에 볼 수 있습니다.'
  },
  {
    cat: 'daily',
    q: '대회 정보는 어떻게 확인하나요?',
    a: '<span class="cmd">/races</span>를 입력하면 국내 마라톤 대회 일정을 확인할 수 있습니다. <strong>지역별, 거리별 필터</strong>도 지원합니다.'
  },
  {
    cat: 'daily',
    q: '러닝 후 자동 분석이 뭔가요?',
    a: 'Garmin에 새 러닝이 기록되면 자동으로 데이터를 동기화하고, AI가 <strong>즉시 분석 및 피드백</strong>을 제공합니다. 별도 명령어 없이 자동으로 작동합니다.'
  },
  {
    cat: 'growth',
    q: '레벨 시스템은 어떻게 되나요?',
    a: '최근 8주 데이터를 기반으로 <strong>5개 지표</strong>(볼륨, 지구력, 꾸준함, 속도, 체력)를 평가하여 초급/중급/고급 레벨을 산정합니다.'
  },
  {
    cat: 'growth',
    q: '마일스톤은 무엇인가요?',
    a: '누적 달성 업적으로, 약 <strong>20개의 마일스톤</strong>이 있습니다. 볼륨, 지구력, 꾸준함, 속도, 체력 카테고리별로 달성 조건이 다릅니다.'
  },
  {
    cat: 'growth',
    q: '퀘스트는 무엇인가요?',
    a: '<span class="cmd">/plan</span> 생성 시 자동으로 <strong>3개의 퀘스트</strong>가 만들어집니다: 코어(횟수 달성), 훈련법(원칙 준수), 스트레치(거리 도전).'
  },
  {
    cat: 'settings',
    q: 'AI 질문 횟수 제한이 있나요?',
    a: '자유 질문은 <strong>하루 10회</strong>까지 가능하며, 매일 자정(KST)에 초기화됩니다. <span class="cmd">/plan</span>, <span class="cmd">/status</span> 등 명령어는 별도 제한이 적용됩니다.'
  },
  {
    cat: 'settings',
    q: '데이터가 동기화되지 않아요',
    a: '연동 설정이 올바른지 확인해 주세요. <span class="cmd">/start</span>로 다시 연동할 수 있습니다. 문제가 지속되면 <span class="cmd">/feedback</span>으로 알려주세요.'
  },
  {
    cat: 'settings',
    q: '피드백은 어떻게 보내나요?',
    a: '<span class="cmd">/feedback</span> 명령어로 개발자에게 직접 전달할 수 있습니다. 건의사항, 버그 신고, 기능 요청 등 무엇이든 보내주세요.'
  }
];

var currentCat = 'all';

function esc(s) { var d = document.createElement('div'); d.textContent = s; return d.innerHTML; }

function renderNav() {
  var nav = document.getElementById('cat-nav');
  var html = '';
  for (var i = 0; i < CATEGORIES.length; i++) {
    var c = CATEGORIES[i];
    html += '<div class="nav-pill' + (c.id === 'all' ? ' active' : '') + '" data-cat="' + c.id + '">' + esc(c.label) + '</div>';
  }
  nav.innerHTML = html;
  nav.addEventListener('click', function(e) {
    var pill = e.target.closest('.nav-pill');
    if (!pill) return;
    var cat = pill.dataset.cat;
    currentCat = cat;
    renderFAQ();
    nav.querySelectorAll('.nav-pill').forEach(function(p) { p.classList.remove('active'); });
    pill.classList.add('active');
    pill.scrollIntoView({ behavior: 'smooth', inline: 'center', block: 'nearest' });
  });
}

function getCatLabel(catId) {
  for (var i = 0; i < CATEGORIES.length; i++) {
    if (CATEGORIES[i].id === catId) return CATEGORIES[i].label;
  }
  return '';
}

function renderFAQ() {
  var list = document.getElementById('faq-list');
  var filtered = currentCat === 'all' ? FAQ : FAQ.filter(function(f) { return f.cat === currentCat; });
  var html = '<div class="faq-list">';

  var lastCat = '';
  for (var i = 0; i < filtered.length; i++) {
    var f = filtered[i];
    if (currentCat === 'all' && f.cat !== lastCat) {
      html += '<div class="cat-label">' + esc(getCatLabel(f.cat)) + '</div>';
      lastCat = f.cat;
    }
    html += '<div class="faq-card" data-idx="' + i + '">' +
      '<div class="faq-q" onclick="toggleFAQ(this)">' +
        '<div class="faq-q-text">' + esc(f.q) + '</div>' +
        '<div class="faq-arrow"><svg viewBox="0 0 24 24"><polyline points="6 9 12 15 18 9"/></svg></div>' +
      '</div>' +
      '<div class="faq-a"><div class="faq-a-inner">' + f.a + '</div></div>' +
    '</div>';
  }

  html += '</div>';
  list.innerHTML = html;
}

function toggleFAQ(el) {
  var card = el.closest('.faq-card');
  var answer = card.querySelector('.faq-a');
  var inner = card.querySelector('.faq-a-inner');

  if (card.classList.contains('open')) {
    card.classList.remove('open');
    answer.style.maxHeight = '0';
  } else {
    // Close other open cards
    document.querySelectorAll('.faq-card.open').forEach(function(c) {
      c.classList.remove('open');
      c.querySelector('.faq-a').style.maxHeight = '0';
    });
    card.classList.add('open');
    answer.style.maxHeight = inner.scrollHeight + 'px';
  }
}

renderNav();
renderFAQ();
</script>
</body>
</html>
